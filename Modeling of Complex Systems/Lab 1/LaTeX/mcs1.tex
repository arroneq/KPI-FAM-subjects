% !TeX program = lualatex
% !TeX encoding = utf8
% !BIB program = biber
% !TeX spellcheck = uk_UA

\documentclass{mathreport}
\input{packages}

\begin{document}

\ReportPreamble{Лабораторна робота №1}
\ReportName{Моделювання газових трубопровідних систем}
\ReportSubject{Моделювання складних систем}

\AuthorInfo{Студент 5 курсу, групи КМ-31мн,}
\AuthorName{Цибульник Антон Владиславович}

\SupervisorInfo{Професор кафедри ПМА,}
\SupervisorName{Ориняк Ігор Володимирович}

% warning: in order to fit the text in the very right side of a page, set the longest label
\TheLongestLabel{Цибульник Антон Владиславович}

\import{Title/}{title}

\tableofcontents

\newpage

\section{Постановка задачі}
% \addcontentsline{toc}{section}{Постановка задачі}

У лабораторній роботі розглядається моделювання газових трубопровідних систем. Газопроводи проєктуються шляхом виокремлення ділянок зі сталою заданою температурою, а відтак кожна точка $s$ системи описується параметром тиску $p(s)$ та масового потоку $Q(s)$.  

Основні рівняння для тисків та потоків у припущенні заданої постійної температури на ділянці трубопровода записуються таким чином:
\begin{align}
    & \frac{dQ(s)}{ds} = 0, \label{eq: initial Q(s) equation} \\
    & p(s)\frac{dp(s)}{ds} = - \mu Q^2(s), \label{eq: initial p(s) equation}
\end{align}
де коефіцієнт $\mu$ прямо пропорційній заданій температурі на ділянці $T$ та обернено пропорційний опору ділянки трубопровода $R:$
\begin{equation}\label{eq: mu coefficient}
    \mu \propto \frac{T}{R} 
\end{equation}

Розв'язками диференціальних рівнянь~\eqref{eq: initial Q(s) equation}-\eqref{eq: initial p(s) equation} слугують вирази
\begin{align}
    & Q(s) = const \label{eq: solved Q(s) equation} \\
    & p^2(s) + 2\mu Q^2(s) s = const \label{eq: solved p(s) equation}
\end{align}

Відтак, для газопроводів виникає додаткова проблема нелінійності основного розв'язку. Однак систему можна лінеаризувати. Перш за все, проблема нелінійності тиску $p(s)$ у рівнянні~\eqref{eq: solved p(s) equation} вирішується шляхом заміни змінних~--- рівняння розв'язується не відносно значення тиску, а відносно квадрату тиску:
\begin{equation}\label{eq: p(s) linearization}
    \mathbf{p(s)} = p^2(s)
\end{equation}

По друге, потік $Q^2(s)$ представимо як суму якогось основного припущення про поточне значення потоку (пробне/базове значення) та малої поправки до нього:
\begin{equation}
    Q(s) = Q_{trial} + Q_{\Delta}(s),
\end{equation}
відтак 
\begin{align}
    Q^2(s) & = \bigl( Q_{trial} + Q_{\Delta}(s) \bigr)^2 = Q^2_{trial} + 2Q_{trial}Q_{\Delta}(s) + Q^2_{\Delta}(s),
\end{align}
де значення $Q^2_{\Delta}(s)$ відкидається в силу своєї мализни:
\begin{align}
    Q^2(s) & = \bigl( Q_{trial} + Q_{\Delta}(s) \bigr)^2 \approx Q^2_{trial} + 2Q_{trial}Q_{\Delta}(s) \label{eq: Q(s) linearization}
\end{align}

Отже, вираз~\eqref{eq: Q(s) linearization} задає лінеаризований вигляд потоку відносно поправочного значення $Q_{\Delta}(s)$. Таким чином, поклавши деяке початкове (базове) значення потоку, маємо змогу знайти розподіл потоків та тисків у газопровідній системі. 

Ітеруючи процес, коригування базового значення потоку на ітерації $i+1$ на основі знайденого поправочного значення на ітерації $i$ відбуватиметься з кроком $\eta$ таким чином:
\begin{equation}\label{eq: Q(s) iterative process}
    Q_{trial}^{i+1} = Q_{trial}^{i} + \eta Q^{i}_{\Delta}(s)
\end{equation}

\section{Метод початкових параметрів}

\subsection*{Ідея та опис методу}
\addcontentsline{toc}{subsection}{Ідея та опис методу}

Метод початкових параметрів (МПП) розглядає довільну систему як такі сутності: елементи; межі між елементами (кінці, вузли), де відбувається спряження дотичних елементів; границі всієї системи. При цьому для системи вводиться поняття потужності $N$ --- кількості параметрів, які визначають стан системи в кожній його точці $s$. Виокремлення окреслених вище сутностей системи відбувається поетапно разом із такими супутніми процедурами:

\begin{enumerate}
    \item Система дробиться на декілька окремих ділянок (елементів), і кожна така ділянка нумерується відповідним чином. Після цього визначаються вхідні та вихідні краї кожного елемента, а також вузли --- точки одночасного дотику декількох елементів. Іншими словами, відбувається організація обходу по елементах системи;
    \item Нумерація невідомих змінних (параметрів) на кожному із двох країв кожного елемента системи;
    \item Складання так званих рівнянь зв’язку для кожного елемента. Ці рівняння зв’язують параметри в кінцевій точці елемента зі значеннями в точці початку елемента. Рівняння зв'язку випливають з фізичних чи геометричних властивостей кожного елемента та системи в цілому;
    \item Складання рівнянь спряження в кожному вузлі системи;
    \item Складання рівнянь, що відповідають граничним умовам системи.
\end{enumerate}

Для системи потужності $N$, що складається з $K$ елементів, кількість невідомих параметрів системи складає $2KN$, адже для кожного елемента визначено невідомі змінні (параметри) на його початку та в його кінці. Відповідно, кількість складених рівнянь згідно з методом початкових параметрів має бути $2KN$.  

\subsection*{Урахування особливостей системи}
\addcontentsline{toc}{subsection}{Урахування особливостей системи}

У контексті задачі моделювання газових трубопроводів, система характеризуватиметься $N=2$ параметрами: тиском та потоком. Рівняння зв'язку задаватимуться диференціальними співвідношеннями~\eqref{eq: solved Q(s) equation}-\eqref{eq: solved p(s) equation} з урахуванням лінеаризованих виразів для тиску~\eqref{eq: p(s) linearization} та потоку~\eqref{eq: Q(s) linearization}. 

Рівняння спряження сусідніх елементів складатимуться з міркувань неперервності тисків у точці дотику. У вузлах дотику $M$ елементів, окрім рівності тисків, буде справедливими силове рівняння балансу потоків згідно з визначеними на першому етапі МПП знаками обходу:
\begin{equation}\label{eq: force equation}
    \sum\limits_{j=1}^{M}{Q_j^{in}(s)} = \sum\limits_{j=1}^{M}{Q_j^{out}(s)}
\end{equation} 

\section{Пошук розв'язку системи №1}

\subsection*{Деталізація поставленої задачі}
\addcontentsline{toc}{subsection}{Деталізація поставленої задачі}

Нехай газопровідна система задана таким чином: задано рівносторонній трикутник з вершинами $A$, $B$ та $C$. Довжина кожної сторони $L=5\,\text{м}$. Усі вершини з'єднані трубами. У точці $A$ тиск $p_A = 20\,\text{Па}$, в точці $B$ тиск $p_B = 6\,\text{Па}$, в точці $C$ тиск $p_C = 10\,\text{Па}$. Опір кожної сторони складає $R = 1\,\text{у.о.}$ ($\mu = 1\,\text{у.о.}$). Слід знайти розподіл потоків $Q(s)$ на кожній трубі системи. 

Виконаємо перший крок методу початкових параметрів~--- реалізуємо організацію обходу по елементах системи (Рис.~\ref{pic: ABC triangle}).

\vspace{0.4cm}
\begin{figure}[H]\centering
    \input{Tikzplots/ABC triangle.tikz}
    \caption{Організація обходу по елементах системи №1}
    \label{pic: ABC triangle}
\end{figure}

Отже, трубопровідна система потужності $N=2$ розділена на $K=3$ елементи та, відповідно, три точки спряження. Тож наступним етапом проведемо нумерацію $2KN=12$ змінних (параметрів системи) на початку та в кінці кожного елемента (Табл.~\ref{table: element numeration}).

\vspace{0.4cm}
\begin{table}[H]\centering
    \begin{tblr}{
            hlines={1pt,solid}, 
            vlines={1pt,solid},
            hline{4}={1-7}{0pt},
            colspec={X[c]X[c]X[c]X[c]X[c]X[c]X[c]},
            cell{1}{1}={r=2, c=1}{c},
            cell{1}{2}={r=1, c=2}{c},
            cell{1}{4}={r=1, c=2}{c},
            cell{1}{6}={r=1, c=2}{c},
            row{3-5}={mode=math},
        }
        
                       & Елемент <<$1$>> & & Елемент <<$2$>> & & Елемент <<$3$>> &  \\
                       & Початок & Кінець  & Початок & Кінець  & Початок & Кінець   \\
        \mathbf{p(s)}  & x_{1}   & x_{3}   & x_{5}   & x_{7}   & x_{9}   & x_{11}   \\
        Q_{\Delta}(s)  & x_{2}   & x_{4}   & x_{6}   & x_{8}   & x_{10}  & x_{12}   \\
        Q^{i}_{trial}  & \alpha^{i}_{2} 
                       & \alpha^{i}_{4} 
                       & \alpha^{i}_{6} 
                       & \alpha^{i}_{8} 
                       & \alpha^{i}_{10} 
                       & \alpha^{i}_{12} \\

    \end{tblr}
    \caption{Нумерація параметрів системи №1}
    \label{table: element numeration}
\end{table}

Далі почергово складемо $2KN=12$ рівнянь для введених змінних. Почнемо з рівнянь зв'язку: початок довільного елемента покладемо в точці $s_0$, а набір базових значень потоків на ітерації $i$ вважатимемо заданим: 
\begin{equation}\label{eq: field equations}
    \begin{pmatrix}
        \mathbf{p(s)} \\
        Q(s)          \\
    \end{pmatrix} =
    \begin{pmatrix}
        1 & -2\,\mu\, Q_{trial}^{i}(s_0)\, s \\
        0 & 1\\
    \end{pmatrix}
    \begin{pmatrix}
        \mathbf{p(s_0)}   \\
        Q_{\Delta}(s_0) \\
    \end{pmatrix} + 
    \begin{pmatrix}
        -|Q_{trial}^{i}(s_0)|\, Q_{trial}^{i}(s_0)\, s \\
        Q_{trial}^{i}(s_0) \\
    \end{pmatrix}
\end{equation} 

Рівняння спряження гарантуватимуть неперервність тисків у точці дотику сусідніх елементів. На додачу до граничних умов задачі, остаточний перелік рівнянь системи наведено у Табл.~\ref{table: part 1 equetions}, Табл.~\ref{table: part 2 equetions} та Табл.~\ref{table: part 3 equetions}.

\vspace{0.4cm}
\begin{table}[H]\centering
    \begin{tblr}{
        hlines={1pt,solid}, 
        vlines={1pt,solid},
        hline{3}={1-3}{0pt},
        colspec={X[l]X[c]X[c]},
        rowsep={4pt},
        cell{2}{2}={r=2,c=1}{c},
        cell{2}{3}={r=2,c=1}{c},
        row{1}={c,m},
        column{1}={9cm},
        column{2}={5.5cm},
        row{2-3}={mode=math},
        cell{2-3}{1}={l, mode=math, cmd=\quad},
    }
    
    Рівняння зв'язку для елемента <<$1$>> & Рівняння спряження елементів <<$1$>> -- <<$3$>> & Гранична умова \\
    x_{3} = x_{1} - 2\,\mu\,|\alpha^{i}_{2}|\,x_{2}\,L - |\alpha^{i}_{2}|\, \alpha^{i}_{2}\, L & x_{1} = x_{11} & x_{1} = 400 \\
    \alpha^{i}_{4} + x_{4} = \alpha^{i}_{2} + x_{2} & & \\

    \end{tblr}
    \caption{Перший блок рівнянь системи №1}
    \label{table: part 1 equetions}
\end{table}

\begin{table}[H]\centering
    \begin{tblr}{
        hlines={1pt,solid}, 
        vlines={1pt,solid},
        hline{3}={1-3}{0pt},
        colspec={X[l]X[c]X[c]},
        rowsep={4pt},
        cell{2}{2}={r=2,c=1}{c},
        cell{2}{3}={r=2,c=1}{c},
        row{1}={c,m},
        column{1}={9cm},
        column{2}={5.5cm},
        row{2-3}={mode=math},
        cell{2-3}{1}={l, mode=math, cmd=\quad},
    }
    
    Рівняння зв'язку для елемента <<$2$>> & Рівняння спряження елементів <<$1$>> -- <<$2$>> & Гранична умова \\
    x_{7} = x_{5} - 2\,\mu\,|\alpha^{i}_{6}|\,x_{6}\,L - |\alpha^{i}_{6}|\, \alpha^{i}_{6}\, L & x_{5} = x_{3} & x_{5} = 36 \\
    \alpha^{i}_{8} + x_{8} = \alpha^{i}_{6} + x_{6} & & \\

    \end{tblr}
    \caption{Другий блок рівнянь системи №1}
    \label{table: part 2 equetions}
\end{table}

\begin{table}[H]\centering
    \begin{tblr}{
        hlines={1pt,solid}, 
        vlines={1pt,solid},
        hline{3}={1-3}{0pt},
        colspec={X[l]X[c]X[c]},
        rowsep={4pt},
        cell{2}{2}={r=2,c=1}{c},
        cell{2}{3}={r=2,c=1}{c},
        row{1}={c,m},
        column{1}={9cm},
        column{2}={5.5cm},
        row{2-3}={mode=math},
        cell{2-3}{1}={l, mode=math, cmd=\quad},
    }
    
    Рівняння зв'язку для елемента <<$3$>> & Рівняння спряження елементів <<$2$>> -- <<$3$>> & Гранична умова \\
    x_{11} = x_{9} - 2\,\mu\,|\alpha^{i}_{10}|\,x_{10}\,L - |\alpha^{i}_{10}|\, \alpha^{i}_{10}\, L & x_{9} = x_{7} & x_{9} = 100 \\
    \alpha^{i}_{12} + x_{12} = \alpha^{i}_{10} + x_{10} & & \\

    \end{tblr}
    \caption{Третій блок рівнянь системи №1}
    \label{table: part 3 equetions}
\end{table}

\subsection*{Візуалізація отриманих результатів}
\addcontentsline{toc}{subsection}{Візуалізація отриманих результатів}

Задавши початковий набір базових значень потоків на ітерації $i=0$ рівними
\begin{equation}
    \alpha^{0}_{2j} = 5,\ j=\overline{1,6},
\end{equation}
проведемо $1000$ ітерацій пошуку розв'язку системи рівнянь (наведеної у Табл.~\ref{table: part 1 equetions}~-- Табл.~\ref{table: part 3 equetions}) для уточнення значення потоку згідно з формулою~\eqref{eq: Q(s) iterative process}, при цьому крок поправки задамо рівним $\eta=0.01$. Значення поправочних потоків для кожного з елементів наведено на рисунках нижче: 

\vspace{0.4cm}
\begin{figure}[H]\centering
    \resizebox{\linewidth}{!}{\input{Tikzplots/AB Q(s) shifts.tikz}}
    % \includegraphics[width=\linewidth]{Tikzplots/TMM.tikz}
    \caption{Поправочне значення потоку на елементі <<$1$>> від ітерації до ітерації}
    \label{pic: AB Q(s) shifts}
\end{figure}

\vspace{0.4cm}
\begin{figure}[H]\centering
    \resizebox{\linewidth}{!}{\input{Tikzplots/BC Q(s) shifts.tikz}}
    % \includegraphics[width=\linewidth]{Tikzplots/TMM.tikz}
    \caption{Поправочне значення потоку на елементі <<$2$>> від ітерації до ітерації}
    \label{pic: BC Q(s) shifts}
\end{figure}

\vspace{0.4cm}
\begin{figure}[H]\centering
    \resizebox{\linewidth}{!}{\input{Tikzplots/CA Q(s) shifts.tikz}}
    % \includegraphics[width=\linewidth]{Tikzplots/TMM.tikz}
    \caption{Поправочне значення потоку на елементі <<$3$>> від ітерації до ітерації}
    \label{pic: CA Q(s) shifts}
\end{figure}

Бачимо, що поправочні значення збігаються до нуля. В результаті, після $1000$ ітерацій отримуємо такий розподіл тисків та потоків системи:

\vspace{0.4cm}
\begin{table}[H]\centering
    \begin{tblr}{
            hlines={1pt,solid}, 
            vlines={1pt,solid},
            % hline{4}={1-7}{0pt},
            rowsep={3pt},
            colspec={X[c]X[c]X[c]X[c]X[c]X[c]X[c]},
            cell{1}{1}={r=2, c=1}{c},
            cell{1}{2}={r=1, c=2}{c},
            cell{1}{4}={r=1, c=2}{c},
            cell{1}{6}={r=1, c=2}{c},
            cell{4}{2}={r=1, c=2}{c},
            cell{4}{4}={r=1, c=2}{c},
            cell{4}{6}={r=1, c=2}{c},
            cell{5}{2}={r=1, c=2}{c},
            cell{5}{4}={r=1, c=2}{c},
            cell{5}{6}={r=1, c=2}{c},
            row{3-5}={mode=math},
        }
        
                         & Елемент <<$1$>> & & Елемент <<$2$>> & & Елемент <<$3$>> &  \\
                         & Початок & Кінець  & Початок & Кінець  & Початок & Кінець   \\
        \mathbf{p(s)}    & 400     & 36      & 36      & 100     & 100     & 400      \\
        Q_{\Delta}(s)    & 0.00012 &         & -0.00023 &        & -0.00022 &         \\
        Q^{1000}_{trial} & 8.53217 &         & -3.57748 &        & -7.74575 &         \\

    \end{tblr}
    \caption{Значення шуканих параметрів системи №1}
    \label{table: element numeration values}
\end{table}

Від'ємні значення потоків сигналізують про те, що на Рис.~\ref{pic: ABC triangle} на відповідній ділянці трубопроводу слід обрати протилежний напрямок обходу. І справді, це відповідає фізичній логіці системи~--- наприклад, від точки найбільшого тиску $A$ тиск саме відтікатиме від неї по обидвох трубам тощо. Крім того, переконуємося, що згідно з отриманими результатами рівняння зв'язку для тисків (Табл.~\ref{table: part 1 equetions}~-- Табл.~\ref{table: part 3 equetions}) виконуються з точністю до $10^{-4}:$
\begin{align}
    36 & = 400 - 2 \cdot 1 \cdot 8.53217 \cdot 0.00012 \cdot 5 - 8.53217 \cdot 8.53217 \cdot 5 \\ 
    100 & = 36 + 2 \cdot 1 \cdot 3.57748 \cdot 0.00023 \cdot 5 + 3.57748 \cdot 3.57748 \cdot 5 \\
    400 & = 100 + 2 \cdot 1 \cdot 7.74575 \cdot 0.00022 \cdot 5 + 7.74575 \cdot 7.74575 \cdot 5
\end{align}

\section{Пошук розв'язку системи №2}

\subsection*{Деталізація поставленої задачі}
\addcontentsline{toc}{subsection}{Деталізація поставленої задачі}

Модифікуємо попередню газопровідну систему таким чином: нехай в центрі заданого трикутника поставили точку $D_0$, яка найкоротшим шляхом з'єднана з кожною стороною. Опір новоутворених з'єднань $R = 3\,\text{у.о.}$ ($\mu = 1/3\,\text{у.о.}$). Слід знайти оновлений розподіл потоків $Q(s)$ на кожній трубі системи, а також тиск в точці $D_0$.

Аналогічним чином виконаємо перший крок методу початкових параметрів~--- реалізуємо організацію обходу по елементах системи (Рис.~\ref{pic: ABCD triangle}). Таким чином, розділимо трубопровідну систему потужності $N=2$ на $K=9$ елементів та чотири вузли. Наступним етапом проведемо нумерацію $2KN=36$ змінних (параметрів системи) на початку та в кінці кожного елемента (Табл.~\ref{table: element numeration (system 2, batch 1)}~-- Табл.~\ref{table: element numeration (system 2, batch 3)}).

Відповідно, для отримання чисельних розв'язків слід скласти $2KN=36$ рівнянь: $18$ рівнянь зв'язку будуть складені аналогічним чином згідно виразу~\eqref{eq: field equations} для кожного з дев'яти елементів системи (так само, як в Табл.~\ref{table: part 1 equetions}~-- Табл.~\ref{table: part 3 equetions}). 

\vspace{0.4cm}
\begin{figure}[H]\centering
    \input{Tikzplots/ABCD triangle.tikz}
    \caption{Організація обходу по елементах системи №2}
    \label{pic: ABCD triangle}
\end{figure}

На додачу до ще $3$-ох рівнянь спряження тисків в точках $A$, $B$, $C$ та $3$-ох граничних умов для цих точок, система включатиме $12$ рівнянь вузлів в точках $D_0$, $D_1$, $D_2$ й $D_3$ згідно з міркуваннями неперервності тиску та збалансованості потоків~\eqref{eq: force equation}. 

\vspace{0.4cm}
\begin{table}[H]\centering
    \begin{tblr}{
            hlines={1pt,solid}, 
            vlines={1pt,solid},
            hline{4}={1-7}{0pt},
            colspec={X[c]X[c]X[c]X[c]X[c]X[c]X[c]},
            cell{1}{1}={r=2, c=1}{c},
            cell{1}{2}={r=1, c=2}{c},
            cell{1}{4}={r=1, c=2}{c},
            cell{1}{6}={r=1, c=2}{c},
            row{3-5}={mode=math},
        }
        
                       & Елемент <<$1$>> & & Елемент <<$2$>> & & Елемент <<$3$>> &  \\
                       & Початок & Кінець  & Початок & Кінець  & Початок & Кінець   \\
        \mathbf{p(s)}  & x_{1}   & x_{3}   & x_{5}   & x_{7}   & x_{9}   & x_{11}   \\
        Q_{\Delta}(s)  & x_{2}   & x_{4}   & x_{6}   & x_{8}   & x_{10}  & x_{12}   \\
        Q^{i}_{trial}  & \alpha^{i}_{2} 
                       & \alpha^{i}_{4} 
                       & \alpha^{i}_{6} 
                       & \alpha^{i}_{8} 
                       & \alpha^{i}_{10} 
                       & \alpha^{i}_{12} \\

    \end{tblr}
    \caption{Нумерація першого блоку параметрів системи №2}
    \label{table: element numeration (system 2, batch 1)}
\end{table}

\vspace{0.4cm}
\begin{table}[H]\centering
    \begin{tblr}{
            hlines={1pt,solid}, 
            vlines={1pt,solid},
            hline{4}={1-7}{0pt},
            colspec={X[c]X[c]X[c]X[c]X[c]X[c]X[c]},
            cell{1}{1}={r=2, c=1}{c},
            cell{1}{2}={r=1, c=2}{c},
            cell{1}{4}={r=1, c=2}{c},
            cell{1}{6}={r=1, c=2}{c},
            row{3-5}={mode=math},
        }
        
                       & Елемент <<$4$>> & & Елемент <<$5$>> & & Елемент <<$6$>> &  \\
                       & Початок & Кінець  & Початок & Кінець  & Початок & Кінець   \\
        \mathbf{p(s)}  & x_{13}  & x_{15}  & x_{17}  & x_{19}  & x_{21}  & x_{23}   \\
        Q_{\Delta}(s)  & x_{14}  & x_{16}  & x_{18}  & x_{20}  & x_{22}  & x_{24}   \\
        Q^{i}_{trial}  & \alpha^{i}_{14} 
                       & \alpha^{i}_{16} 
                       & \alpha^{i}_{18} 
                       & \alpha^{i}_{20} 
                       & \alpha^{i}_{22} 
                       & \alpha^{i}_{24} \\

    \end{tblr}
    \caption{Нумерація другого блоку параметрів системи №2}
    \label{table: element numeration (system 2, batch 2)}
\end{table}

\vspace{0.4cm}
\begin{table}[H]\centering
    \begin{tblr}{
            hlines={1pt,solid}, 
            vlines={1pt,solid},
            hline{4}={1-7}{0pt},
            colspec={X[c]X[c]X[c]X[c]X[c]X[c]X[c]},
            cell{1}{1}={r=2, c=1}{c},
            cell{1}{2}={r=1, c=2}{c},
            cell{1}{4}={r=1, c=2}{c},
            cell{1}{6}={r=1, c=2}{c},
            row{3-5}={mode=math},
        }
        
                       & Елемент <<$7$>> & & Елемент <<$8$>> & & Елемент <<$9$>> &  \\
                       & Початок & Кінець  & Початок & Кінець  & Початок & Кінець   \\
        \mathbf{p(s)}  & x_{25}  & x_{27}   & x_{29} & x_{31}  & x_{33}  & x_{35}   \\
        Q_{\Delta}(s)  & x_{26}  & x_{28}   & x_{30} & x_{32}  & x_{34}  & x_{36}   \\
        Q^{i}_{trial}  & \alpha^{i}_{26} 
                       & \alpha^{i}_{28} 
                       & \alpha^{i}_{30} 
                       & \alpha^{i}_{32} 
                       & \alpha^{i}_{34} 
                       & \alpha^{i}_{36} \\

    \end{tblr}
    \caption{Нумерація третього блоку параметрів системи №2}
    \label{table: element numeration (system 2, batch 3)}
\end{table}

Таким чином, рівняння у вузлі точки $D_0$ матимуть вид:
\begin{align}
    & x_{27} = x_{29}, \\
    & x_{27} = x_{33}, \\
    & \alpha^{i}_{28} + x_{28} = \alpha^{i}_{34} + x_{34} + \alpha^{i}_{30} + x_{30},
\end{align}
рівняння у вузлі точки $D_1:$
\begin{align}
    & x_{3} = x_{5}, \\
    & x_{3} = x_{25}, \\
    & \alpha^{i}_{4} + x_{4} = \alpha^{i}_{26} + x_{26} + \alpha^{i}_{6} + x_{6},
\end{align}
рівняння у вузлі точки $D_2:$
\begin{align}
    & x_{11} = x_{13}, \\
    & x_{11} = x_{31}, \\
    & \alpha^{i}_{12} + x_{12} + \alpha^{i}_{32} + x_{32} = \alpha^{i}_{14} + x_{14},
\end{align}
та рівняння у вузлі точки $D_3:$
\begin{align}
    & x_{19} = x_{21} \\
    & x_{19} = x_{35} \\
    & \alpha^{i}_{36} + x_{36} + \alpha^{i}_{20} + x_{20} = \alpha^{i}_{22} + x_{22}
\end{align}

\subsection*{Візуалізація отриманих результатів}
\addcontentsline{toc}{subsection}{Візуалізація отриманих результатів}

Як і раніше, задамо набір базових значень потоків на ітерації $i=0:$
\begin{equation}
    \alpha^{0}_{2j} = 5,\ j=\overline{1,18}
\end{equation}

Аналогічним чином проведемо $1000$ ітерацій пошуку розв'язку системи рівнянь для уточнення значення потоку згідно з формулою~\eqref{eq: Q(s) iterative process} при кроці $\eta=0.01$. Значення поправочних потоків вибірково продемонстровані на Рис.~\ref{pic: <<1>> Q(s) shifts}~-- Рис.~\ref{pic: <<9>> Q(s) shifts}.

\vspace{0.4cm}
\begin{figure}[H]\centering
    \resizebox{\linewidth}{!}{\input{Tikzplots/<<1>> Q(s) shifts.tikz}}
    % \includegraphics[width=\linewidth]{Tikzplots/TMM.tikz}
    \caption{Поправочне значення потоку на елементі <<$1$>> від ітерації до ітерації}
    \label{pic: <<1>> Q(s) shifts}
\end{figure}

\vspace{0.4cm}
\begin{figure}[H]\centering
    \resizebox{\linewidth}{!}{\input{Tikzplots/<<4>> Q(s) shifts.tikz}}
    % \includegraphics[width=\linewidth]{Tikzplots/TMM.tikz}
    \caption{Поправочне значення потоку на елементі <<$4$>> від ітерації до ітерації}
    \label{pic: <<4>> Q(s) shifts}
\end{figure}

\vspace{0.4cm}
\begin{figure}[H]\centering
    \resizebox{\linewidth}{!}{\input{Tikzplots/<<9>> Q(s) shifts.tikz}}
    % \includegraphics[width=\linewidth]{Tikzplots/TMM.tikz}
    \caption{Поправочне значення потоку на елементі <<$9$>> від ітерації до ітерації}
    \label{pic: <<9>> Q(s) shifts}
\end{figure}

Аналогічний характер збіжності до нуля властивий і для усіх інших елементів системи №2. В результаті, після $1000$ ітерацій отримуємо розподіл тисків та потоків системи, зазначений на Табл.~\ref{table: element numeration values (system 2, batch 1)}~-- Табл.~\ref{table: element numeration values (system 2, batch 3)}.

\vspace{0.4cm}
\begin{table}[H]\centering
    \begin{tblr}{
            hlines={1pt,solid}, 
            vlines={1pt,solid},
            % hline{4}={1-7}{0pt},
            rowsep={3pt},
            colspec={X[c]X[c]X[c]X[c]X[c]X[c]X[c]},
            cell{1}{1}={r=2, c=1}{c},
            cell{1}{2}={r=1, c=2}{c},
            cell{1}{4}={r=1, c=2}{c},
            cell{1}{6}={r=1, c=2}{c},
            cell{4}{2}={r=1, c=2}{c},
            cell{4}{4}={r=1, c=2}{c},
            cell{4}{6}={r=1, c=2}{c},
            cell{5}{2}={r=1, c=2}{c},
            cell{5}{4}={r=1, c=2}{c},
            cell{5}{6}={r=1, c=2}{c},
            row{3-5}={mode=math},
        }
        
                         & Елемент <<$1$>> & & Елемент <<$2$>> & & Елемент <<$3$>> &  \\
                         & Початок & Кінець  & Початок & Кінець  & Початок & Кінець   \\
        \mathbf{p(s)}    & 400     & 170.91  & 170.91  & 36      & 36      & 100.94   \\
        Q_{\Delta}(s)    & 0.00026 &         & -0.00005 &        & -0.00031 &         \\
        Q^{1000}_{trial} & 9.57232 &         & 7.34619 &         & -5.09630 &         \\

    \end{tblr}
    \caption{Значення першого блоку параметрів системи №2}
    \label{table: element numeration values (system 2, batch 1)}
\end{table}

Від’ємні значення потоків, як і у випадку системи №1, сигналізують про те, що на Рис.~\ref{pic: ABCD triangle} на відповідній ділянці трубопроводу слід обрати протилежний напрямок обходу.

\vspace{0.4cm}
\begin{table}[H]\centering
    \begin{tblr}{
            hlines={1pt,solid}, 
            vlines={1pt,solid},
            % hline{4}={1-7}{0pt},
            rowsep={3pt},
            colspec={X[c]X[c]X[c]X[c]X[c]X[c]X[c]},
            cell{1}{1}={r=2, c=1}{c},
            cell{1}{2}={r=1, c=2}{c},
            cell{1}{4}={r=1, c=2}{c},
            cell{1}{6}={r=1, c=2}{c},
            cell{4}{2}={r=1, c=2}{c},
            cell{4}{4}={r=1, c=2}{c},
            cell{4}{6}={r=1, c=2}{c},
            cell{5}{2}={r=1, c=2}{c},
            cell{5}{4}={r=1, c=2}{c},
            cell{5}{6}={r=1, c=2}{c},
            row{3-5}={mode=math},
        }
        
                         & Елемент <<$4$>> &  & Елемент <<$5$>> & & Елемент <<$6$>> &  \\
                         & Початок  & Кінець  & Початок & Кінець  & Початок & Кінець   \\
        \mathbf{p(s)}    & 100.94   & 100     & 100     & 184.28  & 184.28  & 400      \\
        Q_{\Delta}(s)    & -0.00014 &         & -0.00033 &        & -0.00019 &         \\
        Q^{1000}_{trial} & 0.61282  &         & -5.80592 &        & -9.28892 &         \\

    \end{tblr}
    \caption{Значення другого блоку параметрів системи №2}
    \label{table: element numeration values (system 2, batch 2)}
\end{table}

\vspace{0.4cm}
\begin{table}[H]\centering
    \begin{tblr}{
            hlines={1pt,solid}, 
            vlines={1pt,solid},
            % hline{4}={1-7}{0pt},
            rowsep={3pt},
            colspec={X[c]X[c]X[c]X[c]X[c]X[c]X[c]},
            cell{1}{1}={r=2, c=1}{c},
            cell{1}{2}={r=1, c=2}{c},
            cell{1}{4}={r=1, c=2}{c},
            cell{1}{6}={r=1, c=2}{c},
            cell{4}{2}={r=1, c=2}{c},
            cell{4}{4}={r=1, c=2}{c},
            cell{4}{6}={r=1, c=2}{c},
            cell{5}{2}={r=1, c=2}{c},
            cell{5}{4}={r=1, c=2}{c},
            cell{5}{6}={r=1, c=2}{c},
            row{3-5}={mode=math},
        }
        
                         & Елемент <<$7$>> & & Елемент <<$8$>> & & Елемент <<$9$>> &  \\
                         & Початок & Кінець  & Початок & Кінець  & Початок & Кінець   \\
        \mathbf{p(s)}    & 170.91  & 161.68  & 161.68  & 100.94  & 161.68  & 184.28   \\
        Q_{\Delta}(s)    & 0.00009 &         & -0.00004 &        & -0.00008 &         \\
        Q^{1000}_{trial} & 2.22634 &         & 5.70934 &         & -3.48278 &         \\

    \end{tblr}
    \caption{Значення третього блоку параметрів системи №2}
    \label{table: element numeration values (system 2, batch 3)}
\end{table}

Згідно з отриманими результатами рівняння зв'язку, рівняння спряження та рівняння вузлів виконуються з точністю до $10^{-4}$. Зокрема, наведемо справедливість рівнянь для потоків у вузлах $D_0$ та $D_1:$
\begin{align}
    & 0.00009 + 2.22634 = (- 0.00004 + 5.70934) + (- 0.00008 - 3.48278), \\ 
    & 0.00026 + 9.57232 = (0.00009 + 2.22634) + (- 0.00005 + 7.34619),
\end{align}
та аналогічним чином у вузлах $D_2$ та $D_3:$
\begin{align}
    & (- 0.00031 - 5.09630) + (- 0.00004 + 5.70934) = (- 0.00014 + 0.61282) \\ 
    & (- 0.00033 - 5.80592) + (- 0.00008 - 3.48278) = (- 0.00019 - 9.28892)
\end{align}

Наостанок, порівняємо розподіли тисків та потоків для випадку системи №1 (Рис.~\ref{pic: ABC triangle}) та для випадку системи №2 (Рис.~\ref{pic: ABCD triangle}). Наприклад, для порівняльного аналізу обчислимо масовий потік, спрямований у точку $B:$ значення потоку у початковій конфігурації трубопроводів є сумою потоків на відрізках $AB$ та $CB$ і складає $12.10965$, в той час як після модифікацій газопроводу масовий потік у точці $B$ є сумою потоків на проміжках $D_1B$ та $D_2B$ й дорівнює $12.44249$. 

Іншими словами, різниця складає $\delta_{B} = 0.33284$ на користь системи №2. Отже, модифікації трубопроводу призвели до більш оптимального розподілу тисків та потоків у системі.

\newpage
\section{Висновки}

У лабораторній роботі було розглянуто моделювання газової трубопровідної системи, при цьому кожна точка $s$ системи описувалася параметром тиску $p(s)$ та масового потоку $Q(s)$. Для пошуку аналітичного розв'язку системи було використано метод початкових параметрів. Таким чином, як для варіанта системи №1 на Рис.~\ref{pic: ABC triangle}, так і для варіанта системи №2 на Рис.~\ref{pic: ABCD triangle} газопровідна система структурно була розділена на елементи, точки спряження та відповідні вузли.

Диференціальні рівняння, які описують фізику системи, мали особливість~--- нелінійність розв'язку відносно параметрів системи. Тим не менш, вдалося застосувати дві модивікації, які дозволили лінеаризувати розв'язок, а саме: розв'язування рівнянь не відносно значення тиску, а відносно значення квадрату тиску; розклад квадрату потоку на суму складових так званого базового та поправочного значення з подальшою ітеративною процедурою уточнення.

В результаті вдалося показати, що ітеративна процедура демонструє збіжність поправочного значення до нуля. Отже, отримані розподіли тиску та потоків систем із високою точністю коректно відображають моделі газових трубопровідних систем, розглянутих у цій лабораторній роботі.

Крім того, було виявлено, що модифікації системи №1 до вигляду системи №2 шляхом додавання додаткового центрального вузла оптимізували розподіли тисків та потоків, що вказує про інженерну доцільність такого роду видозміни. 

\newpage
\section{Програмна реалізація}

В ході дослідження було використано засоби мови програмування \texttt{Python} версії \texttt{3.8.10} в інтегрованому середовищі розробки \texttt{Visual Studio Code} версії \texttt{1.78.2}. Нижче наведені тексти ключових інструментальних програм.

\lstinputlisting[linerange={1-2}, caption={Підключення бібліотек}]{Code/code.py}

\lstinputlisting[linerange={7-90}, caption={Основний функціональний блок методу початкових параметрів}]{Code/code.py}

\lstinputlisting[linerange={95-117}, caption={Ітеративна процедура та візуалізація результатів для системи №1}]{Code/code.py}

\lstinputlisting[linerange={122-144}, caption={Ітеративна процедура та візуалізація результатів для системи №2}]{Code/code.py}

% \newpage
% \printbibliography[title={Перелік посилань}] % \nocite{*}
% \addcontentsline{toc}{subsection}{Перелік посилань}

\end{document}