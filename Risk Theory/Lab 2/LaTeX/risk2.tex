% !TeX program = lualatex
% !TeX encoding = utf8
% !BIB program = biber
% !TeX spellcheck = uk_UA

\documentclass{mathreport}
\input{packages}

\begin{document}

\ReportPreamble{Лабораторна робота №2}
\ReportName{Динамічний фінансовий аналіз страхової компанії}
\ReportSubject{Методи теорії надійності та ризику}

\AuthorInfo{Студент 5 курсу, групи КМ-31мн,}
\AuthorName{Цибульник Антон Владиславович}

\SupervisorInfo{Професор кафедри ПМА,}
\SupervisorName{Норкін Володимир Іванович}

% warning: in order to fit the text in the very right side of a page, set the longest label
\TheLongestLabel{Цибульник Антон Владиславович}

\import{Title/}{title}

\tableofcontents

\newpage

\section*{Постановка задачі}
\addcontentsline{toc}{section}{Постановка задачі}

Лабораторна робота складається із двох частин~--- обробки статистичних страхових даних щодо компанії <<Арсенал страхування>>~\cite{arsenal-ic} та подальшого динамічного фінансового аналізу наявних страхових даних.

Перша частина лабораторної роботи передбачає взаємодію з базою даних сайту <<Forinsurer>>~\cite{forinsurer}. На основі обробки даних слід витягнути інформацію про квартальні, піврічні та річні валові премії, валові виплати та відповідні рівні виплат за проміжок до $2022$ року. Після цього необхідно побудувати графіки квартальних, піврічних і річних рівнів платежів як функцій часу. Наостанок, потрібно розрахувати середні значення стандартних відхилень для квартальних, піврічних і річних рівнів оплати за останні $3$, $5$ та $10$ років. Результати виконання окреслених завдань наявні у відповідному XLSX файлі~\cite{xlsx}. 

Таким чином, звіт роботи, представлений у цьому документі, буде стосуватися опису кроків другої частини лабораторної роботи, яка передбачає побудову імітаційної моделі фінансового об’єкта, що дозволяє змоделювати майбутні стохастичні доходи та витрати страхової компанії. Застосуванням методу Монте-Карло, тобто шляхом багаторазового статистичного моделювання, слід оцінити ефективність і ризики (наприклад, неплатоспроможність, втрачена вигода тощо) за будь-який період, оцінити прогнозовані результати управлінських рішень. Іншими словами, описані кроки відповідають так званому динамічному фінансовому аналізу, тобто моделюванню та прогнозуванню доходів і витрат у часі.

\section*{Хід дослідження}
\addcontentsline{toc}{section}{Хід дослідження}

\subsection{Результати обробки страхових даних}

В результаті виконання першої частини лабораторної роботи було побудовано низку графіків на основі витягнутих статистичних даних про компанію <<Арсенал страхування>>. Зокрема, наведемо нижче графік рівнів виплат компанії протягом $2014$ -- $2022$ років (Рис.~\ref{pic: annual payout levels}). Судячи з результатів, вважатимемо, що загальний характер отриманих рівнів як числових величин є випадковим (з відчутною тенденцією до зростання за останні роки).

\subsection{Методологія динамічного фінансового аналізу}

У цьому підрозділі розглянемо механізм прогнозування капіталу компанії. Зважаючи на викладки попереднього розділу, введемо для подальших міркувань випадкову величину $\xi$ на позначення рівня виплат. Рівень капіталу на прогнозованому кроці часу $t$ позначимо як $U_t$. 

\begin{figure}[H]\centering
    \input{Tikzplots/annual payout levels.tikz}
    \caption{Рівні виплат страхової компанії <<Арсенал страхування>>}
    \label{pic: annual payout levels}
\end{figure}

Закон зміни валового значення премії $x_t$ покладемо таким чином:
\begin{equation}\label{eq: insurance premium}
    x_t = x_0 + t/N,
\end{equation}
де $N=13$ згідно з номером варіанту, а валове значення премії в початковий момент часу прогнозування ($2022$ рік), відповідно:
\begin{equation}\label{eq: insurance premium at the initial time}
    x_0 = 1\;667\;017\;\text{грн},
\end{equation} 

Тоді, враховуючи, що значення капіталу $U_t$ в початковий момент часу складає
\begin{equation}\label{eq: initial (2022) capital}
    U_0 = 576\;078\;\text{грн},
\end{equation}
то має місце таке рівняння еволюції капіталу страхової компанії на проміжку часу $t=\overline{0,T}:$
\begin{equation}\label{eq: capital}
    U_t = U_{t-1} + (1-\alpha) \cdot x_{t-1} - \xi \cdot x_{t-1},
\end{equation}
де $\alpha$~--- задана частка премій, витрачених на обслуговування договорів страхування, а значення випадкової величини $\xi$ обирається щоразу навмання серед наявної історії рівнів виплат (Рис.~\ref{pic: annual payout levels}). 

\subsection{Застосування методу Монте-Карло}

Метод Монте-Карло полягає у багаторазовому статистичному моделюванні. До прикладу, проведемо $n=5$ генерацій траєкторії еволюції капіталу страхової компанії згідно з формулою~\eqref{eq: capital} на $T=30$ років вперед. Результати моделювання зображені на Рис.~\ref{pic: monte carlo v=0.7}.

\begin{figure}[H]\centering
    \input{Tikzplots/monte carlo v=0.7.tikz}
    \caption{Ілюстрація $n=5$ траєкторій еволюції капіталу компанії при $\alpha=0.7$}
    \label{pic: monte carlo v=0.7}
\end{figure}

Бачимо деякі відмінності між характерами траєкторій. Для підвищення статистичної значущості виконаємо $n=1000$ ітерацій симуляції еволюцій. Крім того, обчислимо середнє значення капіталу $\overline{U_t}$ для кожного прогнозованого року та відповідну імовірність банкрутства~--- частку траєкторій, які перетинають допустиму межу в $L=U_0/N=44\;314\;\text{грн}$. 

Отримані показники проілюстровані на графіку нижче (Рис.~\ref{pic: efficiency-risk v=0.7}). Варто зауважити, що протягом усього дослідження параметр $\alpha$ був навмисно покладений великим для отримання більш красномовних результатів. У наступному розділі буде показано, що при малих $\alpha$ імовірність банкрутства збігається до нуля.

\begin{figure}[H]\centering
    \input{Tikzplots/efficiency-risk v=0.7.tikz}
    \caption{Характеристики $n=1000$ симуляцій еволюції капіталу компанії при параметрі $\alpha=0.7$ протягом $2022$ -- $2052$ років}
    \label{pic: efficiency-risk v=0.7}
\end{figure}

\subsection{Прогін різних значень параметра $\alpha$}

Обчислимо імовірність банкрутства страхової компанії при різних значеннях частки премій $\alpha$, витрачених на обслуговування договорів страхування. Інші параметри моделі залишимо незмінними, зокрема і кількість симуляцій $n=1000$.

\begin{figure}[H]
    \begin{minipage}[H]{0.47\linewidth}\centering
        \center{\input{Tikzplots/monte carlo v=0.2.tikz}} a) $\alpha=0.2 : P(U_t < L) = 0.0$
    \end{minipage} 
    \hfill
    \begin{minipage}[H]{0.47\linewidth}\centering
        \input{Tikzplots/monte carlo v=0.4.tikz} б) $\alpha=0.4 : P(U_t < L) = 0.0$
    \end{minipage} 
\end{figure}

\begin{figure}[H]
    \begin{minipage}[H]{0.47\linewidth}\centering
        \center{\input{Tikzplots/monte carlo v=0.6.tikz}} в) $\alpha=0.6 : P(U_t < L) = 0.0$
    \end{minipage} 
    \hfill
    \begin{minipage}[H]{0.47\linewidth}\centering
        \input{Tikzplots/monte carlo v=0.8.tikz} г) $\alpha=0.8 : P(U_t < L) = 1.0$
    \end{minipage} 
    \caption{Траєкторії еволюцій капіталу компанії при різних значеннях $\alpha$}
    \label{pic: evolution alpha = 0.2,0.4,0.6,0.8}
\end{figure}

Зауважимо, що в силу обмежених ресурсів компілятора \LaTeX, на Рис.~\ref{pic: evolution alpha = 0.2,0.4,0.6,0.8} проілюстровані схематичні креслення динаміки траєкторій на прикладі лише невеликої кількості ліній. Безпосередньо в обчисленнях імовірності банкрутства використовувалися, як і раніше, всі $n=1000$ симуляцій.

\newpage
\printbibliography[title={Перелік посилань}] % \nocite{*}
\addcontentsline{toc}{section}{Перелік посилань}

\newpage
\section*{Програмна реалізація}
\addcontentsline{toc}{section}{Програмна реалізація}

В ході дослідження було використано засоби мови програмування \texttt{Python} версії \texttt{3.8.10} в інтегрованому середовищі розробки \texttt{Visual Studio Code} версії \texttt{1.78.2}. Нижче наведені тексти ключових інструментальних програм.

\lstinputlisting[linerange={1-3}, caption={Підключення бібліотек}]{Code/code.py}

\lstinputlisting[linerange={5-17}, caption={Ініціалізація та візуалізація параметрів}]{Code/code.py}

\lstinputlisting[linerange={19-42}, caption={Імплементація методу Монте-Карло}]{Code/code.py}

\lstinputlisting[linerange={44-52}, caption={Обчислення характеристик симуляції еволюції капіталу компанії}]{Code/code.py}

\end{document}